{
    "collab_server" : "",
    "contents" : "knitr::opts_chunk$set(eval = FALSE, message=FALSE, warning=FALSE)\n\n\n#  basic library packages\nlibrary(httr)\nlibrary(XML)\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(magrittr)\nlibrary(twitteR)\nlibrary(ggplot2)\nlibrary(RKlout)\nlibrary(plotly)\n\nrequire('ROAuth')\nrequire('RCurl')\n\nsource(\"keys.R\")\n\n#Set up Twitter authentication\n\nsetup_twitter_oauth(id,pw,token,secret)\nsave(setup_twitter_oauth, file=\"twitter authentication.Rdata\")\n\n#Retrieve Tweets\n\nMAX_TWEETS <- 3200\ntweets_raw_MDT <- userTimeline('MDT_Diabetes', n = MAX_TWEETS,\n                           includeRts = FALSE, excludeReplies = TRUE)\n\ntweets_raw_Omni <- userTimeline('myomnipod', n = MAX_TWEETS,\n                                includeRts = FALSE, excludeReplies = TRUE)\n\ntweets_raw_Tandem <- userTimeline('TandemDiabetes', n = MAX_TWEETS,\n                                includeRts = FALSE, excludeReplies = TRUE)\n\ntweets_raw_Onetouch <- userTimeline('OneTouch', n = MAX_TWEETS,\n                                  includeRts = FALSE, excludeReplies = TRUE)\n\n\ntweets_raw_Accucheck <- userTimeline('accuchek_us', n = MAX_TWEETS,\n                                  includeRts = FALSE, excludeReplies = TRUE)\n\n\ntweets_raw_Abbott <- userTimeline('abbott', n = MAX_TWEETS,\n                                     includeRts = FALSE, excludeReplies = TRUE)\n\n# Retrieve Twitter User handle information\n\nMDT <- getUser(\"MDT_Diabetes\")\nOmni <- getUser(\"myomnipod\")\nTandem <- getUser(\"TandemDiabetes\")\nOnetouch <- getUser(\"OneTouch\")\nAccu <- getUser(\"accuchek_us\")\nAbbott <- getUser(\"FreeStyleDiabet\")\n\n#Creating data frames with necessary fields\n\ntweets_MDT <- \n  ldply(tweets_raw_MDT, function(x) {\n    data_frame(id = x$id,\n               date = as.Date(x$created),\n               day = weekdays(date),\n               favorites = x$favoriteCount,\n               retweets = x$retweetCount,\n               title = x$text\n    )\n  })\n\n\ntweets_Omni <- \n  ldply(tweets_raw_Omni, function(x) {\n    data_frame(id = x$id,\n               date = as.Date(x$created),\n               day = weekdays(date),\n               favorites = x$favoriteCount,\n               retweets = x$retweetCount,\n               title = x$text\n    )\n  })\n\ntweets_Tandem <- \n  ldply(tweets_raw_Tandem, function(x) {\n    data_frame(id = x$id,\n               date = as.Date(x$created),\n               day = weekdays(date),\n               favorites = x$favoriteCount,\n               retweets = x$retweetCount,\n               title = x$text\n    )\n  })\n\n\ntweets_Onetouch <- \n  ldply(tweets_raw_Onetouch, function(x) {\n    data_frame(id = x$id,\n               date = as.Date(x$created),\n               day = weekdays(date),\n               favorites = x$favoriteCount,\n               retweets = x$retweetCount,\n               title = x$text\n    )\n  })\n\ntweets_Accucheck <- \n  ldply(tweets_raw_Accucheck, function(x) {\n    data_frame(id = x$id,\n               date = as.Date(x$created),\n               day = weekdays(date),\n               favorites = x$favoriteCount,\n               retweets = x$retweetCount,\n               title = x$text\n    )\n  })\n\ntweets_Abbott <- \n  ldply(tweets_raw_Abbott, function(x) {\n    data_frame(id = x$id,\n               date = as.Date(x$created),\n               day = weekdays(date),\n               favorites = x$favoriteCount,\n               retweets = x$retweetCount,\n               title = x$text\n    )\n  })\n\n#List of Glucose Monitor data frames\nlist_tweets_gm <- list(tweets_MDT,tweets_Omni,tweets_Tandem)\n\n#List of Meter Maker data frames\nlist_tweets_mm <- list(tweets_Onetouch,tweets_Accucheck,tweets_Abbott)\n\n# All possible punctuation symbols\npunct <- '[]\\\\?!\\\"\\'#$%&(){}+*/:;,._`|~\\\\[<=>@\\\\^-]'\n\n# Punctuation without '#'\npunct2 <- sub(\"#\",\"\", punct)\n\n# Pre-processing Glucose Monitor companies' Data Frames containing tweets\n\nfor (i in 1:length(list_tweets_gm))\n{\n  list_tweets_gm[[i]]$title <- mapply(gsub, sprintf(\"http[^[:space:]]*\"), \"\", list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub('\\\\b+RT', '', list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub('@\\\\S+', '', list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub('[[:cntrl:]]', '', list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub(\"\\\\d\", '', list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub(punct2, '', list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub(\"^[[:space:]]*\",\"\", list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub(\"[[:space:]]*$\",\"\", list_tweets_gm[[i]]$title)\n  list_tweets_gm[[i]]$title <- gsub(' +',' ', list_tweets_gm[[i]]$title)\n}\n\n# Pre-processing Meter Maker companies' Data Frames containing tweets\n\nfor (i in 1:length(list_tweets_mm))\n{\n  list_tweets_mm[[i]]$title <- mapply(gsub, sprintf(\"http[^[:space:]]*\"), \"\", list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub('\\\\b+RT', '', list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub('@\\\\S+', '', list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub('[[:cntrl:]]', '', list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub(\"\\\\d\", '', list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub(punct2, '', list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub(\"^[[:space:]]*\",\"\", list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub(\"[[:space:]]*$\",\"\", list_tweets_mm[[i]]$title)\n  list_tweets_mm[[i]]$title <- gsub(' +',' ', list_tweets_mm[[i]]$title)\n}\n\n#Creating reference date value to match and retrive tweets in the month of November\ndate <- \"2016-11-08\"\ntemp <- as.Date(date)\ntemp1 <- format(temp, \"%y-%m\")\n\n#Creating a subset with tweets posted in the month of November\n\ntweets_MDT_nov <- subset(tweets_MDT, temp1 == (format(as.Date(tweets_MDT$date), \"%y-%m\")))\n\ntweets_Omni_nov <- subset(tweets_Omni, temp1 == (format(as.Date(tweets_Omni$date), \"%y-%m\")))\n\ntweets_Tandem_nov <- subset(tweets_Tandem, temp1 == (format(as.Date(tweets_Tandem$date), \"%y-%m\")))\n\ntweets_Onetouch_nov <- subset(tweets_Onetouch, temp1 == (format(as.Date(tweets_Onetouch$date), \"%y-%m\")))\n\ntweets_Accucheck_nov <- subset(tweets_Accucheck, temp1 == (format(as.Date(tweets_Accucheck$date), \"%y-%m\")))\n\ntweets_Abbott_nov <- subset(tweets_Abbott, temp1 == (format(as.Date(tweets_Abbott$date), \"%y-%m\")))\n\n#List of Glucose Monitor data frames for the month of November\nlist_tweets_gm_nov <- list(tweets_MDT_nov,tweets_Omni_nov,tweets_Tandem_nov)\n\n#List of Meter Maker data frames for the month of November\nlist_tweets_mm_nov <- list(tweets_Onetouch_nov,tweets_Accucheck_nov,tweets_Abbott_nov)\n\nValue_GM <- list(0,0,0)\nValue_MM <- list(0,0,0)\n\n#Calculating Score and Value Metric for Glucose Moniter Companies\n\n# Value - Sum(Fav)/Sum(Retweets)\n# Score - favorites + 2*Retweets\n\nfor (i in 1:length(list_tweets_gm_nov)){\n  for (j in 1:nrow(list_tweets_gm_nov[[i]])){\n  \n    \n    Value_GM[i] <- sum(list_tweets_gm_nov[[i]]$favorites) / sum(list_tweets_gm_nov[[i]]$retweets)\n    list_tweets_gm_nov[[i]]$Score[j] <- list_tweets_gm_nov[[i]]$favorites[j] + list_tweets_gm_nov[[i]]$retweets[j] * 2\n  }\n}\n\n\n    \n#Calculating Score and Value Metric for Meter Maker Companies\n\nfor (i in 1:length(list_tweets_mm_nov)){\n  for (j in 1:nrow(list_tweets_mm_nov[[i]])){\n    \n    \n    Value_MM[i] <- sum(list_tweets_mm_nov[[i]]$favorites) / sum(list_tweets_mm_nov[[i]]$retweets)\n    list_tweets_mm_nov[[i]]$Score[j] <- list_tweets_mm_nov[[i]]$favorites[j] + list_tweets_mm_nov[[i]]$retweets[j] * 2\n  }\n}\n\n#Amalgamating all the dataframes into a single list and creating a big data frame\n\nlist_tweets_gm_nov[[1]]$User <- rep('MDT',nrow(list_tweets_gm_nov[[1]]))\nlist_tweets_gm_nov[[2]]$User <- rep('Omni',nrow(list_tweets_gm_nov[[2]]))\nlist_tweets_gm_nov[[3]]$User <- rep('Tandem',nrow(list_tweets_gm_nov[[3]]))\n\n\nlist_tweets_mm_nov[[1]]$User <- rep('Onetouch',nrow(list_tweets_mm_nov[[1]]))\nlist_tweets_mm_nov[[2]]$User <- rep('Accu',nrow(list_tweets_mm_nov[[2]]))\nlist_tweets_mm_nov[[3]]$User <- rep('Abbott',nrow(list_tweets_mm_nov[[3]]))\n\n\nDF_GM_NOV <- data.frame(rbind(list_tweets_gm_nov[[1]],list_tweets_gm_nov[[2]],list_tweets_gm_nov[[3]]))\n\n\nDF_MM_NOV <- data.frame(rbind(list_tweets_mm_nov[[1]],list_tweets_mm_nov[[2]],list_tweets_mm_nov[[3]]))\n\n\n\n# Preliminary Look at Glucose Monitor Companies November Tweet Data\n\nggplot(DF_GM_NOV) +\n  geom_point(aes(DF_GM_NOV$favorites,DF_GM_NOV$retweets, fill = DF_GM_NOV$User), size = 5, shape = 21) +\n  theme_bw(30) +\n  scale_fill_brewer(\"User\", type = \"qual\", palette = 3) +\n  ggtitle(\"Score of November tweets by Glucose Monitor Makers\") +\n  xlab(\"# favorites\") + ylab(\"# retweets\")\n\n# Preliminary Look at Meter Maker Companies November Tweet Data\n\nggplot(DF_MM_NOV) +\n  geom_point(aes(DF_MM_NOV$favorites,DF_MM_NOV$retweets, fill = DF_MM_NOV$User), size = 5, shape = 21) +\n  theme_bw(30) +\n  scale_fill_brewer(\"User\", type = \"qual\", palette = 3) +\n  ggtitle(\"Score of November tweets by Meter Makers\") +\n  xlab(\"# favorites\") + ylab(\"# retweets\")\n\n#Glucose Monitor Companies Twitter User Related information \n\nlist_gm_user <- list( c('MDT', 'Omni', 'Tandem'))\nlist_gm_followers <- list(c(MDT$followersCount,Omni$followersCount,Tandem$followersCount))\nlist_gm_tweetcount <- list(c(length(tweets_raw_MDT),length(tweets_raw_Omni),length(tweets_raw_Tandem)))\nlist_gm_Novtweetcount <- list(c(nrow(tweets_MDT_nov),nrow(tweets_Omni_nov),nrow(tweets_Tandem_nov)))\nlist_gm_Value <- list(c(Value_GM[[1]],Value_GM[[2]],Value_GM[[3]]))\nlist_gm_retweetcount <- list(c(sum(tweets_MDT$retweets),sum(tweets_Omni$retweets),sum(tweets_Tandem$retweets)))\nlist_gm_novretweetcount <- list(c(sum(tweets_MDT_nov$retweets),sum(tweets_Omni_nov$retweets),sum(tweets_Tandem_nov$retweets)))\nlist_gm_favorites <- list(c(sum(tweets_MDT$favorites),sum(tweets_Omni$favorites),sum(tweets_Tandem$favorites)))\nlist_gm_novfavoritescount <- list(c(sum(tweets_MDT_nov$favorites),sum(tweets_Omni_nov$favorites),sum(tweets_Tandem_nov$favorites)))\nlist_gm_novAvgScore <- list(c(mean(list_tweets_gm_nov[[1]]$Score),mean(list_tweets_gm_nov[[2]]$Score),mean(list_tweets_gm_nov[[3]]$Score)))\nlist_gm_novAvgFavorites <- list(c(mean(list_tweets_gm_nov[[1]]$favorites),mean(list_tweets_gm_nov[[2]]$favorites),mean(list_tweets_gm_nov[[3]]$favorites)))\nlist_gm_novAvgRetweets <- list(c(mean(list_tweets_gm_nov[[1]]$retweets),mean(list_tweets_gm_nov[[2]]$retweets),mean(list_tweets_gm_nov[[3]]$retweets)))\nlist_gm_Score <- list(c(sum(sum(tweets_MDT$favorites),2*sum(tweets_MDT$retweets)),sum(sum(tweets_Omni$favorites),2*sum(tweets_Omni$retweets)),sum(sum(tweets_Tandem$favorites),2*sum(tweets_Tandem$retweets))))\n\n\nGM_DF <- data.frame(list_gm_user,list_gm_followers,list_gm_tweetcount,list_gm_Novtweetcount,list_gm_retweetcount,list_gm_novretweetcount,list_gm_Value,list_gm_novAvgFavorites,list_gm_novAvgRetweets,list_gm_novAvgScore,list_gm_favorites,list_gm_Score)\n\ncolnames(GM_DF)[1] <- 'gm_user'\ncolnames(GM_DF)[2] <- 'gm_followerscount'\ncolnames(GM_DF)[3] <- 'gm_tweetcount'\ncolnames(GM_DF)[4] <- 'gm_Novtweetcount'\ncolnames(GM_DF)[5] <- 'gm_retweetcount'\ncolnames(GM_DF)[6] <- 'gm_Novretweetcount'\ncolnames(GM_DF)[7] <- 'gm_NovValue'\ncolnames(GM_DF)[8] <- 'gm_NovAvgFavorites'\ncolnames(GM_DF)[9] <- 'gm_NovAvgRetweets'\ncolnames(GM_DF)[10] <- 'gm_NovAvgScore'\ncolnames(GM_DF)[11] <- 'gm_favorites'\ncolnames(GM_DF)[12] <- 'gm_score'\n\nGM_DF$gm_user <- as.factor(GM_DF$gm_user)\n\n# Comparing Followers and Tweets of a Glucose Monitor Makers twitter users \n\nggplot(GM_DF) +\n  geom_point(aes(GM_DF$gm_followerscount,GM_DF$gm_tweetcount, fill = GM_DF$gm_user), size = 5, shape = 21) +\n  theme_bw(30) +\n  scale_fill_brewer(\"User\", type = \"qual\", palette = 3) +\n  ggtitle(\"Followers vs Tweets Count Glucose Monitor\") +\n  xlab(\"# followers\") + ylab(\"# tweets\")\n\n# Comparing Followers and (Score= (2*ReTweets+Favorites) of a Glocose Monitor Makers twitter users\nggplot(GM_DF) +\n  geom_point(aes(GM_DF$gm_followerscount,GM_DF$gm_score, fill = GM_DF$gm_user), size = 5, shape = 21) +\n  theme_bw(30) +\n  scale_fill_brewer(\"User\", type = \"qual\", palette = 3) +\n  ggtitle(\"Impact of Followers\") +\n  xlab(\"# followers\") + ylab(\"Score\")\n\n\n\n#Meter Maker Companies Twitter User Related information\n\nlist_mm_user <- list( c('OneTouch', 'Accu', 'Abbott'))\nlist_mm_followers <- list(c(Onetouch$followersCount,Accu$followersCount,Abbott$followersCount))\nlist_mm_tweetcount <- list(c(length(tweets_raw_Onetouch),length(tweets_raw_Accucheck),length(tweets_raw_Abbott)))\nlist_mm_Novtweetcount <- list(c(nrow(tweets_Onetouch_nov),nrow(tweets_Accucheck_nov),nrow(tweets_Abbott_nov)))\nlist_mm_Value <- list(c(Value_MM[[1]],Value_MM[[2]],Value_MM[[3]]))\nlist_mm_retweetcount <- list(c(sum(tweets_Onetouch$retweets),sum(tweets_Accucheck$retweets),sum(tweets_Abbott$retweets)))\nlist_mm_novretweetcount <- list(c(sum(tweets_Onetouch_nov$retweets),sum(tweets_Accucheck_nov$retweets),sum(tweets_Abbott_nov$retweets)))\nlist_mm_favorites <- list(c(sum(tweets_Onetouch$favorites),sum(tweets_Accucheck$favorites),sum(tweets_Abbott$favorites)))\nlist_mm_novfavoritescount <- list(c(sum(tweets_Onetouch_nov$favorites),sum(tweets_Accucheck_nov$favorites),sum(tweets_Abbott_nov$favorites)))\nlist_mm_novAvgScore <- list(c(mean(list_tweets_mm_nov[[1]]$Score),mean(list_tweets_mm_nov[[2]]$Score),mean(list_tweets_mm_nov[[3]]$Score)))\nlist_mm_novAvgFavorites <- list(c(mean(list_tweets_mm_nov[[1]]$favorites),mean(list_tweets_mm_nov[[2]]$favorites),mean(list_tweets_mm_nov[[3]]$favorites)))\nlist_mm_novAvgRetweets <- list(c(mean(list_tweets_mm_nov[[1]]$retweets),mean(list_tweets_mm_nov[[2]]$retweets),mean(list_tweets_mm_nov[[3]]$retweets)))\nlist_mm_Score <- list(c(sum(sum(tweets_Onetouch$favorites),2*sum(tweets_Onetouch$retweets)),sum(sum(tweets_Accucheck$favorites),2*sum(tweets_Accucheck$retweets)),sum(sum(tweets_Abbott$favorites),2*sum(tweets_Abbott$retweets))))\n\n\nMM_DF <- data.frame(list_mm_user,list_mm_followers,list_mm_tweetcount,list_mm_Novtweetcount,list_mm_retweetcount,list_mm_novretweetcount,list_mm_Value,list_mm_novAvgFavorites,list_mm_novAvgRetweets,list_mm_novAvgScore,list_mm_favorites,list_mm_Score)\n\ncolnames(MM_DF)[1] <- 'mm_user'\ncolnames(MM_DF)[2] <- 'mm_followerscount'\ncolnames(MM_DF)[3] <- 'mm_tweetcount'\ncolnames(MM_DF)[4] <- 'mm_Novtweetcount'\ncolnames(MM_DF)[5] <- 'mm_retweetcount'\ncolnames(MM_DF)[6] <- 'mm_Novretweetcount'\ncolnames(MM_DF)[7] <- 'mm_NovValue'\ncolnames(MM_DF)[8] <- 'mm_NovAvgFavorites'\ncolnames(MM_DF)[9] <- 'mm_NovAvgRetweets'\ncolnames(MM_DF)[10] <- 'mm_NovAvgScore'\ncolnames(MM_DF)[11] <- 'mm_favorites'\ncolnames(MM_DF)[12] <- 'mm_score'\n\nMM_DF$mm_user <- as.factor(MM_DF$mm_user)\n\n# Comparing Followers and Tweets of a Meter Maker Monitor Makers twitter users\n\nggplot(MM_DF) +\n  geom_point(aes(MM_DF$mm_followerscount,MM_DF$mm_tweetcount, fill = MM_DF$mm_user), size = 5, shape = 21) +\n  theme_bw(30) +\n  scale_fill_brewer(\"User\", type = \"qual\", palette = 3) +\n  ggtitle(\"Followers vs Tweets Count Meter Maker\") +\n  xlab(\"# followers\") + ylab(\"# tweets\")\n\n# Comparing Followers and (Score= (2*ReTweets+Favorites) of a Meter Maker Monitor Makers twitter users\nggplot(MM_DF) +\n  geom_point(aes(MM_DF$mm_followerscount,MM_DF$mm_score, fill = MM_DF$mm_user), size = 5, shape = 21) +\n  theme_bw(30) +\n  scale_fill_brewer(\"User\", type = \"qual\", palette = 3) +\n  ggtitle(\"Impact of Followers\") +\n  xlab(\"# followers\") + ylab(\"Score\")\n\n# Tabular Report of Twitter User Information of Glucose Monitor Makers\n\nd.table_GM <- xtable(GM_DF[,c(1,4,8,9,10)])\ngrid.table(d.table_GM)\n\n# Tabular Report of Twitter User Information of Meter Makers\n\nd.table_MM <- xtable(MM_DF[,c(1,4,8,9,10)])\ngrid.table(d.table_MM)\n\n#Calculating Klout Score\n\nMDT_Klout <- RKlout(klout_key,'MDT_Diabetes')\nOmni_Klout <- RKlout(klout_key,'myomnipod')\nTandem_Klout <- RKlout(klout_key,'TandemDiabetes')\nOnetouch_Klout <- RKlout(klout_key,'OneTouch')\nAccuchek_Klout <- RKlout(klout_key,'accuchek_us')\nAbbott_Klout <- RKlout(klout_key,'FreeStyleDiabet')\n\n#Klout Score Graph\nplot_ly(\n  x = c(\"MDT\", \"Omni\", \"Tandem\"),\n  y = c(MDT_Klout,Omni_Klout,Tandem_Klout),\n  name = \"GM Klout Score\",\n  type = \"bar\"\n)\n\nplot_ly(\n  x = c(\"OneToch\", \"Accu-chek\", \"Abbott\"),\n  y = c(Onetouch_Klout,Accuchek_Klout,Abbott_Klout),\n  name = \"MM Klout Score\",\n  type = \"bar\"\n)\n\n#Plot determining the performance in November\n\n# Comparing Followers and (Score= (2*ReTweets+Favorites) of a Glucose Monitor Maker twitter users\n\nplot_ly(data = GM_DF, x = GM_DF$gm_followerscount, y = GM_DF$gm_NovAvgScore, color = GM_DF$gm_user) %>%\nlayout(title = \"November Followers Impact for Glucose Monitor Makers\",\n         xaxis = list(title = \"Followers\"), \n         yaxis = list(title = \"Average Score\"))\n\n# Comparing Followers and (Score= (2*ReTweets+Favorites) of a Meter Maker twitter users\nplot_ly(data = MM_DF, x = MM_DF$mm_followerscount, y = MM_DF$mm_NovAvgScore, color = MM_DF$mm_user) %>%\n  layout(title = \"November Followers Impact for Meter Makers\",\n         xaxis = list(title = \"Followers\"), \n         yaxis = list(title = \"Average Score\"))\n\n\n",
    "created" : 1483670783520.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3636988591",
    "id" : "D3BAE69",
    "lastKnownWriteTime" : 1484121485,
    "last_content_update" : 1484121485623,
    "path" : "C:/Users/Sai/Downloads/R Programming/Glooko Challenge/glooko/data_challenge.r",
    "project_path" : "data_challenge.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}